# 論争解析モジュール 入出力例

## 入力例（リクエスト）

```json
{
  "messages": [
    {
      "speaker": "A",
      "text": "AIの導入により労働効率が大幅に向上すると思います。特に定型業務の自動化で時間を節約できます。"
    },
    {
      "speaker": "B", 
      "text": "しかし、AI導入には大きなリスクがあります。プライバシーの問題や雇用への影響を考慮すべきです。"
    },
    {
      "speaker": "A",
      "text": "プライバシーについては適切な規制を設けることで対応できます。雇用については新しい職種が生まれる可能性もあります。"
    },
    {
      "speaker": "B",
      "text": "規制だけでは不十分です。技術的な安全性も確保する必要があります。また、失業者の再訓練コストも考慮すべきです。"
    },
    {
      "speaker": "A",
      "text": "確かに安全性は重要ですね。段階的な導入と十分なテスト期間を設けることで、リスクを最小化できると思います。"
    }
  ],
  "analysis_depth": "standard"
}
```

## 出力例（レスポンス）

```json
{
  "success": true,
  "data": {
    "analysis": {
      "topics": [
        {
          "topic_id": "topic_1",
          "topic_name": "AI導入の労働効率向上",
          "confidence": 0.92,
          "keywords": ["AI", "労働効率", "自動化", "時間節約"]
        },
        {
          "topic_id": "topic_2", 
          "topic_name": "AI導入のリスク管理",
          "confidence": 0.88,
          "keywords": ["リスク", "プライバシー", "雇用", "安全性"]
        },
        {
          "topic_id": "topic_3",
          "topic_name": "AI導入の段階的アプローチ",
          "confidence": 0.85,
          "keywords": ["段階的", "テスト", "規制", "安全性確保"]
        }
      ],
      "relations": [
        {
          "topic": "AI導入の労働効率向上",
          "a_position": "賛成",
          "b_position": "懸念",
          "relation_type": "対立",
          "intensity": 0.7
        },
        {
          "topic": "AI導入のリスク管理",
          "a_position": "段階的対応",
          "b_position": "慎重な検討",
          "relation_type": "部分的合意",
          "intensity": 0.4
        },
        {
          "topic": "AI導入の段階的アプローチ",
          "a_position": "賛成",
          "b_position": "条件付き賛成",
          "relation_type": "合意",
          "intensity": 0.2
        }
      ],
      "message_analyses": [
        {
          "speaker": "A",
          "text": "AIの導入により労働効率が大幅に向上すると思います。特に定型業務の自動化で時間を節約できます。",
          "classification": {
            "category": "主張",
            "confidence": 0.89,
            "subcategory": "積極的主張"
          },
          "topics": ["AI導入の労働効率向上"],
          "sentiment": null
        },
        {
          "speaker": "B",
          "text": "しかし、AI導入には大きなリスクがあります。プライバシーの問題や雇用への影響を考慮すべきです。",
          "classification": {
            "category": "反論",
            "confidence": 0.91,
            "subcategory": "直接反論"
          },
          "topics": ["AI導入のリスク管理"],
          "sentiment": null
        },
        {
          "speaker": "A",
          "text": "プライバシーについては適切な規制を設けることで対応できます。雇用については新しい職種が生まれる可能性もあります。",
          "classification": {
            "category": "根拠",
            "confidence": 0.85,
            "subcategory": "論理根拠"
          },
          "topics": ["AI導入のリスク管理"],
          "sentiment": null
        },
        {
          "speaker": "B",
          "text": "規制だけでは不十分です。技術的な安全性も確保する必要があります。また、失業者の再訓練コストも考慮すべきです。",
          "classification": {
            "category": "反論",
            "confidence": 0.88,
            "subcategory": "条件反論"
          },
          "topics": ["AI導入のリスク管理"],
          "sentiment": null
        },
        {
          "speaker": "A",
          "text": "確かに安全性は重要ですね。段階的な導入と十分なテスト期間を設けることで、リスクを最小化できると思います。",
          "classification": {
            "category": "同意",
            "confidence": 0.87,
            "subcategory": "部分同意"
          },
          "topics": ["AI導入の段階的アプローチ"],
          "sentiment": null
        }
      ],
      "summary": {
        "total_topics": 3,
        "total_relations": 3,
        "conflict_intensity": 0.43,
        "main_disputes": ["AI導入の労働効率向上"],
        "agreement_areas": ["AI導入の段階的アプローチ"]
      }
    },
    "usage": {
      "gemini_tokens": null,
      "bert_inferences": 5,
      "processing_time_ms": 2150
    },
    "meta": {
      "model": "gemini-1.5-flash+cl-tohoku/bert-base-japanese-v3",
      "analysis_depth": "standard",
      "total_messages": 5
    }
  },
  "error": null
}
```

## エラー例

```json
{
  "success": false,
  "data": null,
  "error": {
    "code": "INVALID_INPUT",
    "message": "At least 2 messages are required for analysis",
    "details": null
  }
}
```

## API使用例

### cURLコマンド例

```bash
curl -X POST "http://localhost:8082/v1/analyze" \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [
      {"speaker": "A", "text": "この提案に賛成です。"},
      {"speaker": "B", "text": "私は反対です。リスクが高すぎます。"}
    ],
    "analysis_depth": "standard"
  }'
```

### Python使用例

```python
import requests
import json

# APIエンドポイント
url = "http://localhost:8082/v1/analyze"

# リクエストデータ
data = {
    "messages": [
        {"speaker": "A", "text": "この提案に賛成です。"},
        {"speaker": "B", "text": "私は反対です。リスクが高すぎます。"}
    ],
    "analysis_depth": "standard"
}

# リクエスト実行
response = requests.post(url, json=data)

if response.status_code == 200:
    result = response.json()
    print("解析成功:")
    print(f"論点数: {len(result['data']['analysis']['topics'])}")
    print(f"対立強度: {result['data']['analysis']['summary']['conflict_intensity']}")
else:
    print(f"エラー: {response.status_code}")
    print(response.text)
```
